<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; pyKVFinder 0.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
    <link rel="shortcut icon" href="../../_static/icon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=fe7df9b0"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API Reference" href="../api_reference/index.html" />
    <link rel="prev" title="Installation" href="../installation/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            pyKVFinder
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Python Package</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cavity-detection-and-characterization">Cavity detection and characterization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#standard-workflow">Standard workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#full-workflow">Full workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#separated-steps">Separated steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#loading-van-der-waals-radii-dictionary">1. Loading van der Waals radii dictionary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-data-from-target-structure">2. Loading data from target structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dimensioning-the-3d-grid">3. Dimensioning the 3D grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detecting-biomolecular-cavities">4. Detecting biomolecular cavities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detecting-biomolecular-cavities-with-ligand-adjustment">4.1 Detecting biomolecular cavities with ligand adjustment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-spatial-characterization">5. Performing spatial characterization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-constitutional-characterization">6. Performing constitutional characterization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calculating-and-plotting-frequencies">6.1 Calculating and plotting frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-hydropathy-characterization">7. Performing hydropathy characterization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performing-depth-characterization">8. Performing depth characterization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exporting-cavities">9. Exporting cavities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#writing-results">10.   Writing results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#steered-detection">Steered detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#workflows">Workflows</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Separated steps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#molecular-volume">Molecular volume</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vdw-volume">1. vdW volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ses-volume">2. SES volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sas-volume">3. SAS volume</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plugins</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/cli/index.html">Command-line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/pymol/index.html">PyMOL pyKVFinder Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">Issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html#scientific-team">Scientific team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html#citing-pykvfinder">Citing pyKVFinder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html#funding">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html#license">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyKVFinder</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/package/tutorial/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h1>
<p>This section is an introductory overview of pyKVFinder features. For detailed reference documentation of the functions and classes contained in the package, see the <a class="reference external" href="../api_reference/index.html">API reference</a>.</p>
<p>Before reading this section, you should know a bit of Python. If you would like to refresh your memory, refer to this <a class="reference external" href="https://docs.python.org/3/tutorial/">Python tutorial</a>.</p>
<p>First of all, import pyKVFinder package on Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyKVFinder</span>
</pre></div>
</div>
<section id="cavity-detection-and-characterization">
<h2>Cavity detection and characterization<a class="headerlink" href="#cavity-detection-and-characterization" title="Link to this heading"></a></h2>
<p>All files used on this tutorial can be found in our package and in our <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder">GitHub repository</a>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/tests/1FMO.pdb">1FMO.pdb</a></p></li>
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/tests/ADN.pdb">ADN.pdb</a></p></li>
</ul>
<p>In this tutorial, we will use pyKVFinder on a catalytic subunit of a cAMP-dependent protein kinase (cADK) to identify and characterize its cavities.</p>
<p>pyKVFinder can be imported as a Python package in Python environment and users can decide to run the full pyKVFinder <a class="reference external" href="index.html#workflows">workflow</a> through the single pyKVFinder function or run pyKVFinder functions in a <a class="reference external" href="index.html#separated-steps">stepwise</a> fashion.</p>
<section id="standard-workflow">
<h3>Standard workflow<a class="headerlink" href="#standard-workflow" title="Link to this heading"></a></h3>
<p>The <strong>standard workflow</strong> for cavity detection with spatial and constitutional characterization (volume, area and interface residues) can be run at once with one command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;1FMO.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">run_workflow</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span>
<span class="go">&lt;pyKVFinderResults object&gt;</span>
</pre></div>
</div>
<p>Inside the <em>pyKVFinderResults object</em>, cavity and surface points, number of cavities, volume, area, and interface residues and their frequencies are stored as attributes. Below, we show how to access them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">cavities</span>
<span class="go">array([[[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        ...,</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1]],</span>

<span class="go">      ...,</span>

<span class="go">      [[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        ...,</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1]]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">surface</span>
<span class="go">array([[[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        ...,</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1]],</span>

<span class="go">      ...,</span>

<span class="go">      [[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        ...,</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">        [-1, -1, -1, ..., -1, -1, -1]]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">ncav</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">volume</span>
<span class="go">{&#39;KAA&#39;: 137.16, &#39;KAB&#39;: 47.52, &#39;KAC&#39;: 66.96, &#39;KAD&#39;: 8.21, &#39;KAE&#39;: 43.63, &#39;KAF&#39;: 12.53, &#39;KAG&#39;: 6.26, &#39;KAH&#39;: 520.13, &#39;KAI&#39;: 12.31, &#39;KAJ&#39;: 26.57, &#39;KAK&#39;: 12.31, &#39;KAL&#39;: 33.91, &#39;KAM&#39;: 23.11, &#39;KAN&#39;: 102.82, &#39;KAO&#39;: 6.05, &#39;KAP&#39;: 15.55, &#39;KAQ&#39;: 7.99, &#39;KAR&#39;: 7.78}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">area</span>
<span class="go">{&#39;KAA&#39;: 126.41, &#39;KAB&#39;: 62.37, &#39;KAC&#39;: 74.57, &#39;KAD&#39;: 19.06, &#39;KAE&#39;: 57.08, &#39;KAF&#39;: 22.77, &#39;KAG&#39;: 15.38, &#39;KAH&#39;: 496.97, &#39;KAI&#39;: 30.58, &#39;KAJ&#39;: 45.64, &#39;KAK&#39;: 30.58, &#39;KAL&#39;: 45.58, &#39;KAM&#39;: 45.25, &#39;KAN&#39;: 129.77, &#39;KAO&#39;: 12.28, &#39;KAP&#39;: 25.04, &#39;KAQ&#39;: 13.46, &#39;KAR&#39;: 16.6}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">residues</span>
<span class="go">{&#39;KAA&#39;: [[&#39;14&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;15&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;18&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;19&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;100&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;152&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;155&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;156&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;292&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;302&#39;, &#39;E&#39;, &#39;TRP&#39;], [&#39;303&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;306&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAB&#39;: [[&#39;18&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;22&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;25&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;26&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;29&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;97&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;98&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;99&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;156&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAC&#39;: [[&#39;141&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;142&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;144&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;145&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;148&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;299&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;300&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;305&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;310&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;311&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;313&#39;, &#39;E&#39;, &#39;PRO&#39;]], &#39;KAD&#39;: [[&#39;122&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;124&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;176&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;318&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;320&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;321&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;322&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;323&#39;, &#39;E&#39;, &#39;ASP&#39;]], &#39;KAE&#39;: [[&#39;95&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;98&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;99&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;100&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;103&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;104&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;105&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;106&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAF&#39;: [[&#39;123&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;124&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;175&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;176&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;181&#39;, &#39;E&#39;, &#39;GLN&#39;]], &#39;KAG&#39;: [[&#39;34&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;37&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;96&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;106&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;107&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;108&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;109&#39;, &#39;E&#39;, &#39;SER&#39;]], &#39;KAH&#39;: [[&#39;49&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;50&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;52&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;53&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;54&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;55&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;57&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;70&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;72&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;74&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;84&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;87&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;88&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;91&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;104&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;120&#39;, &#39;E&#39;, &#39;MET&#39;], [&#39;121&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;122&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;123&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;127&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;166&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;168&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;170&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;171&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;173&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;183&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;184&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;186&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;187&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;201&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;327&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAI&#39;: [[&#39;131&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;138&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;142&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;146&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;174&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;314&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAJ&#39;: [[&#39;33&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;89&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;92&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;93&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;96&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;349&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;350&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAK&#39;: [[&#39;157&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;162&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;163&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;164&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;185&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;188&#39;, &#39;E&#39;, &#39;ALA&#39;]], &#39;KAL&#39;: [[&#39;49&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;127&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;129&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;130&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;326&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;327&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;328&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;330&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAM&#39;: [[&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;55&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;73&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;74&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;75&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;115&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;335&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;336&#39;, &#39;E&#39;, &#39;ARG&#39;]], &#39;KAN&#39;: [[&#39;165&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;166&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;167&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;199&#39;, &#39;E&#39;, &#39;CYS&#39;], [&#39;200&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;201&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;204&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;205&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;206&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;209&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;219&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;220&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;223&#39;, &#39;E&#39;, &#39;ALA&#39;]], &#39;KAO&#39;: [[&#39;48&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;330&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;331&#39;, &#39;E&#39;, &#39;GLU&#39;]], &#39;KAP&#39;: [[&#39;222&#39;, &#39;E&#39;, &#39;TRP&#39;], [&#39;238&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;253&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;254&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;255&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;273&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAQ&#39;: [[&#39;207&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;208&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;211&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;213&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;275&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;277&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAR&#39;: [[&#39;237&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;238&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;249&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;254&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;255&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;256&#39;, &#39;E&#39;, &#39;ARG&#39;]]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">frequencies</span>
<span class="go">{&#39;KAA&#39;: {&#39;RESIDUES&#39;: {&#39;GLU&#39;: 1, &#39;ILE&#39;: 1, &#39;LEU&#39;: 2, &#39;LYS&#39;: 1, &#39;PHE&#39;: 2, &#39;SER&#39;: 1, &#39;TRP&#39;: 1, &#39;TYR&#39;: 2, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 5, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAB&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 2, &#39;ASN&#39;: 1, &#39;ASP&#39;: 1, &#39;LYS&#39;: 1, &#39;PHE&#39;: 2, &#39;TYR&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 3, &#39;R2&#39;: 3, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAC&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ARG&#39;: 1, &#39;GLU&#39;: 1, &#39;HIS&#39;: 1, &#39;ILE&#39;: 1, &#39;PHE&#39;: 1, &#39;PRO&#39;: 2, &#39;THR&#39;: 2, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 5, &#39;R2&#39;: 1, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAD&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ASP&#39;: 1, &#39;GLN&#39;: 1, &#39;GLY&#39;: 2, &#39;PHE&#39;: 1, &#39;PRO&#39;: 1, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 2, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAE&#39;: {&#39;RESIDUES&#39;: {&#39;ASN&#39;: 1, &#39;LEU&#39;: 3, &#39;LYS&#39;: 1, &#39;PHE&#39;: 1, &#39;VAL&#39;: 2}, &#39;CLASS&#39;: {&#39;R1&#39;: 5, &#39;R2&#39;: 1, &#39;R3&#39;: 1, &#39;R4&#39;: 0, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAF&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ASP&#39;: 1, &#39;GLN&#39;: 2, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 2, &#39;R2&#39;: 0, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAG&#39;: {&#39;RESIDUES&#39;: {&#39;GLN&#39;: 1, &#39;GLU&#39;: 1, &#39;LEU&#39;: 1, &#39;PHE&#39;: 1, &#39;SER&#39;: 2, &#39;THR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 1, &#39;R2&#39;: 1, &#39;R3&#39;: 4, &#39;R4&#39;: 1, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAH&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ARG&#39;: 1, &#39;ASN&#39;: 1, &#39;ASP&#39;: 2, &#39;GLN&#39;: 1, &#39;GLU&#39;: 4, &#39;GLY&#39;: 4, &#39;HIS&#39;: 1, &#39;LEU&#39;: 3, &#39;LYS&#39;: 2, &#39;MET&#39;: 1, &#39;PHE&#39;: 3, &#39;SER&#39;: 1, &#39;THR&#39;: 4, &#39;TYR&#39;: 1, &#39;VAL&#39;: 3}, &#39;CLASS&#39;: {&#39;R1&#39;: 11, &#39;R2&#39;: 4, &#39;R3&#39;: 8, &#39;R4&#39;: 6, &#39;R5&#39;: 4, &#39;RX&#39;: 0}}, &#39;KAI&#39;: {&#39;RESIDUES&#39;: {&#39;HIS&#39;: 2, &#39;ILE&#39;: 1, &#39;PHE&#39;: 2, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 1, &#39;R2&#39;: 3, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAJ&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 1, &#39;GLN&#39;: 1, &#39;GLU&#39;: 1, &#39;LEU&#39;: 1, &#39;LYS&#39;: 1, &#39;PHE&#39;: 1, &#39;PRO&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 2, &#39;R2&#39;: 1, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAK&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ILE&#39;: 1, &#39;LEU&#39;: 2, &#39;PHE&#39;: 1, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 2, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAL&#39;: {&#39;RESIDUES&#39;: {&#39;ASN&#39;: 1, &#39;ASP&#39;: 1, &#39;GLU&#39;: 1, &#39;LEU&#39;: 1, &#39;PHE&#39;: 2, &#39;SER&#39;: 1, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 1, &#39;R2&#39;: 3, &#39;R3&#39;: 2, &#39;R4&#39;: 2, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAM&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 2, &#39;ASN&#39;: 1, &#39;ASP&#39;: 1, &#39;GLY&#39;: 1, &#39;ILE&#39;: 2, &#39;LEU&#39;: 1, &#39;THR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 0, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAN&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 2, &#39;ARG&#39;: 1, &#39;ASP&#39;: 2, &#39;CYS&#39;: 1, &#39;GLY&#39;: 1, &#39;ILE&#39;: 1, &#39;LEU&#39;: 2, &#39;THR&#39;: 1, &#39;TYR&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 7, &#39;R2&#39;: 1, &#39;R3&#39;: 2, &#39;R4&#39;: 2, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAO&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 1, &#39;GLU&#39;: 1, &#39;THR&#39;: 2, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 0, &#39;R2&#39;: 1, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAP&#39;: {&#39;RESIDUES&#39;: {&#39;GLY&#39;: 1, &#39;LEU&#39;: 1, &#39;LYS&#39;: 1, &#39;PHE&#39;: 1, &#39;TRP&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 3, &#39;R2&#39;: 2, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAQ&#39;: {&#39;RESIDUES&#39;: {&#39;GLU&#39;: 1, &#39;LEU&#39;: 2, &#39;LYS&#39;: 1, &#39;PRO&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 0, &#39;R3&#39;: 0, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAR&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 1, &#39;LYS&#39;: 2, &#39;PHE&#39;: 1, &#39;PRO&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 2, &#39;R2&#39;: 1, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 3, &#39;RX&#39;: 0}}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity points belonging to the same cavity receive the same integer label in the grid. The code numbering is the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>-1: bulk points.</p></li>
<li><p>0: biomolecule points.</p></li>
<li><p>1: empty space points.</p></li>
<li><p>&gt;=2: cavity points.</p></li>
</ul>
</div></blockquote>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The surface points belonging to the same cavity receive the same integer label in the grid. The code numbering is the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>-1: bulk points.</p></li>
<li><p>0: biomolecule or empty space points.</p></li>
<li><p>&gt;=2: cavity points.</p></li>
</ul>
</div></blockquote>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyKVFinder.run_workflow</span></code> function uses default parameter specifications and therefore parameters can be adjusted to users’ needs.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/run_workflow">pyKVFinder.run_workflow</a></p></li>
</ul>
</div>
<p>With these attributes, we can write the detected cavities and the characterization to files. Further, we can set a flag to plot the bar charts of the frequencies in a PDF file. Below, we illustrate the usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">export_all</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="s1">&#39;results.toml&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;cavity.pdb&#39;</span><span class="p">,</span> <span class="n">include_frequencies_pdf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pdf</span><span class="o">=</span><span class="s1">&#39;barplots.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyKVFinder.pyKVFinderResults.export_all</span></code> methods uses default parameter specifications, except for <code class="docutils literal notranslate"><span class="pre">include_frequencies_pdf</span></code> parameter, and therefore parameters can be adjusted to users’ needs.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/pyKVFinderResults.html">pyKVFinder.pyKVFinderResults</a></p></li>
</ul>
</div>
</section>
<section id="full-workflow">
<h3>Full workflow<a class="headerlink" href="#full-workflow" title="Link to this heading"></a></h3>
<p>However, users may opt to perform the <strong>full workflow</strong> for cavity detection with spatial (volume and area), constitutional (interface residues), hydropathy and depth characterization. This full workflow can be run with one command by setting some parameters of <code class="docutils literal notranslate"><span class="pre">pyKVFinder.run_workflow</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">run_workflow</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">include_depth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_hydropathy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hydrophobicity_scale</span><span class="o">=</span><span class="s1">&#39;EisenbergWeiss&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Inside the <em>pyKVFinderResults object</em>, in addition to cavity and surface points, volume, area, and interface residues and their frequencies showed above, depth and hydropathy points, average depth, maximum depth and average hydropathy are also stored as attributes. Below, we show how to access them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">depths</span>
<span class="go">array([[[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        ...,</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.]],</span>

<span class="go">      ...,</span>

<span class="go">      [[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        ...,</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">scales</span>
<span class="go">array([[[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        ...,</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.]],</span>

<span class="go">      ...,</span>

<span class="go">      [[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        ...,</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">        [0., 0., 0., ..., 0., 0., 0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">avg_depth</span>
<span class="go">{&#39;KAA&#39;: 1.35, &#39;KAB&#39;: 0.91, &#39;KAC&#39;: 0.68, &#39;KAD&#39;: 0.32, &#39;KAE&#39;: 0.99, &#39;KAF&#39;: 0.24, &#39;KAG&#39;: 0.1, &#39;KAH&#39;: 3.91, &#39;KAI&#39;: 0.0, &#39;KAJ&#39;: 0.96, &#39;KAK&#39;: 0.0, &#39;KAL&#39;: 1.07, &#39;KAM&#39;: 0.24, &#39;KAN&#39;: 0.0, &#39;KAO&#39;: 0.29, &#39;KAP&#39;: 0.7, &#39;KAQ&#39;: 0.22, &#39;KAR&#39;: 0.12}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">max_depth</span>
<span class="go">{&#39;KAA&#39;: 3.79, &#39;KAB&#39;: 2.68, &#39;KAC&#39;: 2.62, &#39;KAD&#39;: 0.85, &#39;KAE&#39;: 3.0, &#39;KAF&#39;: 0.85, &#39;KAG&#39;: 0.6, &#39;KAH&#39;: 10.73, &#39;KAI&#39;: 0.0, &#39;KAJ&#39;: 2.24, &#39;KAK&#39;: 0.0, &#39;KAL&#39;: 3.0, &#39;KAM&#39;: 1.2, &#39;KAN&#39;: 0.0, &#39;KAO&#39;: 1.04, &#39;KAP&#39;: 2.08, &#39;KAQ&#39;: 0.85, &#39;KAR&#39;: 0.6}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">avg_hydropathy</span>
<span class="go">{&#39;KAA&#39;: -0.73, &#39;KAB&#39;: -0.05, &#39;KAC&#39;: -0.07, &#39;KAD&#39;: -0.62, &#39;KAE&#39;: -0.81, &#39;KAF&#39;: -0.14, &#39;KAG&#39;: -0.33, &#39;KAH&#39;: -0.17, &#39;KAI&#39;: -0.4, &#39;KAJ&#39;: 0.62, &#39;KAK&#39;: -0.99, &#39;KAL&#39;: 0.36, &#39;KAM&#39;: -0.33, &#39;KAN&#39;: 0.18, &#39;KAO&#39;: 0.88, &#39;KAP&#39;: -0.96, &#39;KAQ&#39;: 0.48, &#39;KAR&#39;: 0.24, &#39;EisenbergWeiss&#39;: [-1.42, 2.6]}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyKVFinder.run_workflow</span></code> function uses default parameter specifications, except for <code class="docutils literal notranslate"><span class="pre">include_depth</span></code> and <code class="docutils literal notranslate"><span class="pre">include_hydropathy</span></code> parameters, and therefore parameters can be adjusted to users’ needs.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/run_workflow">pyKVFinder.run_workflow</a></p></li>
</ul>
</div>
<p>With these attributes, we can write the detected cavities with depth annotated on B-factor column (temperature factor) and hydropathy annotated on Q-factor (occupancy) column, and the characterization to files. Below, we illustrate the usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="o">.</span><span class="n">export_all</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="s1">&#39;results.toml&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;cavity.pdb&#39;</span><span class="p">,</span> <span class="n">include_frequencies_pdf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyKVFinder.pyKVFinderResults.export_all</span></code> methods uses default parameter specifications, and therefore parameters can be adjusted to users’ needs.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/pyKVFinderResults.html">pyKVFinder.pyKVFinderResults</a></p></li>
</ul>
</div>
</section>
<section id="separated-steps">
<h3>Separated steps<a class="headerlink" href="#separated-steps" title="Link to this heading"></a></h3>
<p>If users prefer, instead of running <code class="docutils literal notranslate"><span class="pre">pyKVFinder.run_workflow</span></code> function, you can apply the cavity detection and characterization in a step-by-step fashion. Below we describe each step in detail.</p>
<section id="loading-van-der-waals-radii-dictionary">
<h4>1. Loading van der Waals radii dictionary<a class="headerlink" href="#loading-van-der-waals-radii-dictionary" title="Link to this heading"></a></h4>
<p>The <a class="reference external" href="../_cfg_files/vdw_file_template.html">van der Waals radii file</a> define the radius values for each residue and when not defined, it uses a generic value based on the atom type. <code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_vdw</span></code> takes a vdW radii file (<em>.dat</em>) and returns a dictionary contaning radii values for each atom of each residue.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vdw</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">read_vdw</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vdw</span>
<span class="go">{&#39;ALA&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB1&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;3HB&#39;: 1.487, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;ARG&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;2HG&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;HG1&#39;: 1.487, &#39;1HG&#39;: 1.487, &#39;CD&#39;: 1.908, &#39;HD2&#39;: 1.387, &#39;1HD&#39;: 1.387, &#39;2HD&#39;: 1.387, &#39;HD3&#39;: 1.387, &#39;HD1&#39;: 1.387, &#39;NE&#39;: 1.75, &#39;HE&#39;: 0.6, &#39;CZ&#39;: 1.908, &#39;NH1&#39;: 1.75, &#39;HH11&#39;: 0.6, &#39;1HH1&#39;: 0.6, &#39;HH12&#39;: 0.6, &#39;2HH1&#39;: 0.6, &#39;NH2&#39;: 1.75, &#39;HH21&#39;: 0.6, &#39;2HH2&#39;: 0.6, &#39;HH22&#39;: 0.6, &#39;1HH2&#39;: 0.6, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;ASH&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;OD1&#39;: 1.6612, &#39;OD2&#39;: 1.721, &#39;HD2&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;ASN&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;OD1&#39;: 1.6612, &#39;ND2&#39;: 1.824, &#39;HD21&#39;: 0.6, &#39;1HD2&#39;: 0.6, &#39;HD22&#39;: 0.6, &#39;2HD2&#39;: 0.6, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;ASP&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;OD1&#39;: 1.6612, &#39;OD2&#39;: 1.6612, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;CYM&#39;: {&#39;N&#39;: 1.824, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB3&#39;: 1.387, &#39;HB2&#39;: 1.387, &#39;SG&#39;: 2.0, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;CYS&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.387, &#39;2HB&#39;: 1.387, &#39;1HB&#39;: 1.387, &#39;HB3&#39;: 1.387, &#39;HB1&#39;: 1.387, &#39;SG&#39;: 2.0, &#39;HG&#39;: 0.6, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;CYX&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.387, &#39;HB3&#39;: 1.387, &#39;SG&#39;: 2.0, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;GLH&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;CD&#39;: 1.908, &#39;OE1&#39;: 1.6612, &#39;OE2&#39;: 1.721, &#39;HE2&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;GLN&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;2HG&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;HG1&#39;: 1.487, &#39;1HG&#39;: 1.487, &#39;CD&#39;: 1.908, &#39;OE1&#39;: 1.6612, &#39;NE2&#39;: 1.824, &#39;HE21&#39;: 0.6, &#39;1HE2&#39;: 0.6, &#39;HE22&#39;: 0.6, &#39;2HE2&#39;: 0.6, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;GLU&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;2HG&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;HG1&#39;: 1.487, &#39;1HG&#39;: 1.487, &#39;CD&#39;: 1.908, &#39;OE1&#39;: 1.6612, &#39;OE2&#39;: 1.6612, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;GLY&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA2&#39;: 1.387, &#39;HA1&#39;: 1.387, &#39;1HA&#39;: 1.387, &#39;2HA&#39;: 1.387, &#39;HA3&#39;: 1.387, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;HID&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.85, &#39;ND1&#39;: 1.75, &#39;HD1&#39;: 0.6, &#39;CE1&#39;: 1.85, &#39;HE1&#39;: 1.359, &#39;NE2&#39;: 1.75, &#39;CD2&#39;: 2.0, &#39;HD2&#39;: 1.409, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;HIE&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.85, &#39;ND1&#39;: 1.75, &#39;CE1&#39;: 1.85, &#39;HE1&#39;: 1.359, &#39;NE2&#39;: 1.75, &#39;HE2&#39;: 0.6, &#39;CD2&#39;: 2.0, &#39;HD2&#39;: 1.409, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;HIP&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.85, &#39;ND1&#39;: 1.75, &#39;HD1&#39;: 0.6, &#39;CE1&#39;: 1.85, &#39;HE1&#39;: 1.359, &#39;NE2&#39;: 1.75, &#39;HE2&#39;: 0.6, &#39;CD2&#39;: 2.0, &#39;HD2&#39;: 1.409, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;ILE&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB&#39;: 1.487, &#39;CG2&#39;: 1.908, &#39;HG21&#39;: 1.487, &#39;1HG2&#39;: 1.487, &#39;HG22&#39;: 1.487, &#39;2HG2&#39;: 1.487, &#39;HG23&#39;: 1.487, &#39;3HG2&#39;: 1.487, &#39;CG1&#39;: 1.908, &#39;HG12&#39;: 1.487, &#39;2HG1&#39;: 1.487, &#39;HG13&#39;: 1.487, &#39;HG11&#39;: 1.487, &#39;1HG1&#39;: 1.487, &#39;CD1&#39;: 1.908, &#39;HD11&#39;: 1.487, &#39;1HD1&#39;: 1.487, &#39;HD12&#39;: 1.487, &#39;2HD1&#39;: 1.487, &#39;HD13&#39;: 1.487, &#39;3HD1&#39;: 1.487, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;LEU&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG&#39;: 1.487, &#39;CD1&#39;: 1.908, &#39;HD11&#39;: 1.487, &#39;1HD1&#39;: 1.487, &#39;HD12&#39;: 1.487, &#39;2HD1&#39;: 1.487, &#39;HD13&#39;: 1.487, &#39;3HD1&#39;: 1.487, &#39;CD2&#39;: 1.908, &#39;HD21&#39;: 1.487, &#39;1HD2&#39;: 1.487, &#39;HD22&#39;: 1.487, &#39;2HD2&#39;: 1.487, &#39;HD23&#39;: 1.487, &#39;3HD2&#39;: 1.487, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;LYN&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;CD&#39;: 1.908, &#39;HD2&#39;: 1.487, &#39;HD3&#39;: 1.487, &#39;CE&#39;: 1.908, &#39;HE2&#39;: 1.1, &#39;HE3&#39;: 1.1, &#39;NZ&#39;: 1.824, &#39;HZ2&#39;: 0.6, &#39;HZ3&#39;: 0.6, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;LYS&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;2HG&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;HG1&#39;: 1.487, &#39;1HG&#39;: 1.487, &#39;CD&#39;: 1.908, &#39;HD2&#39;: 1.487, &#39;1HD&#39;: 1.487, &#39;2HD&#39;: 1.487, &#39;HD3&#39;: 1.487, &#39;HD1&#39;: 1.487, &#39;CE&#39;: 1.908, &#39;HE2&#39;: 1.1, &#39;2HE&#39;: 1.1, &#39;HE3&#39;: 1.1, &#39;1HE&#39;: 1.1, &#39;HE1&#39;: 1.1, &#39;NZ&#39;: 1.824, &#39;HZ1&#39;: 0.6, &#39;1HZ&#39;: 0.6, &#39;HZ2&#39;: 0.6, &#39;2HZ&#39;: 0.6, &#39;HZ3&#39;: 0.6, &#39;3HZ&#39;: 0.6, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;MET&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.387, &#39;2HG&#39;: 1.387, &#39;HG3&#39;: 1.387, &#39;HG1&#39;: 1.387, &#39;1HG&#39;: 1.387, &#39;SD&#39;: 2.0, &#39;CE&#39;: 1.908, &#39;HE1&#39;: 1.387, &#39;1HE&#39;: 1.387, &#39;HE2&#39;: 1.387, &#39;2HE&#39;: 1.387, &#39;HE3&#39;: 1.387, &#39;3HE&#39;: 1.387, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;PHE&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;CD1&#39;: 1.908, &#39;HD1&#39;: 1.459, &#39;CE1&#39;: 1.908, &#39;HE1&#39;: 1.459, &#39;CZ&#39;: 1.908, &#39;HZ&#39;: 1.459, &#39;CE2&#39;: 1.908, &#39;HE2&#39;: 1.459, &#39;CD2&#39;: 1.908, &#39;HD2&#39;: 1.459, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;PRO&#39;: {&#39;N&#39;: 1.824, &#39;CD&#39;: 1.908, &#39;HD2&#39;: 1.387, &#39;1HD&#39;: 1.387, &#39;2HD&#39;: 1.387, &#39;HD3&#39;: 1.387, &#39;HD1&#39;: 1.387, &#39;CG&#39;: 1.908, &#39;HG2&#39;: 1.487, &#39;2HG&#39;: 1.487, &#39;HG3&#39;: 1.487, &#39;HG1&#39;: 1.487, &#39;1HG&#39;: 1.487, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;SER&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.387, &#39;2HB&#39;: 1.387, &#39;1HB&#39;: 1.387, &#39;HB3&#39;: 1.387, &#39;HB1&#39;: 1.387, &#39;OG&#39;: 1.721, &#39;HG&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;THR&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB&#39;: 1.387, &#39;CG2&#39;: 1.908, &#39;HG21&#39;: 1.487, &#39;1HG2&#39;: 1.487, &#39;HG22&#39;: 1.487, &#39;2HG2&#39;: 1.487, &#39;HG23&#39;: 1.487, &#39;3HG2&#39;: 1.487, &#39;OG1&#39;: 1.721, &#39;HG1&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;TRP&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.85, &#39;CD1&#39;: 2.0, &#39;HD1&#39;: 1.409, &#39;NE1&#39;: 1.75, &#39;HE1&#39;: 0.6, &#39;CE2&#39;: 1.85, &#39;CZ2&#39;: 1.908, &#39;HZ2&#39;: 1.459, &#39;CH2&#39;: 1.908, &#39;HH2&#39;: 1.459, &#39;CZ3&#39;: 1.908, &#39;HZ3&#39;: 1.459, &#39;CE3&#39;: 1.908, &#39;HE3&#39;: 1.459, &#39;CD2&#39;: 1.85, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;TYR&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;CD1&#39;: 1.908, &#39;HD1&#39;: 1.459, &#39;CE1&#39;: 1.908, &#39;HE1&#39;: 1.459, &#39;CZ&#39;: 1.908, &#39;OH&#39;: 1.721, &#39;HH&#39;: 0.0001, &#39;CE2&#39;: 1.908, &#39;HE2&#39;: 1.459, &#39;CD2&#39;: 1.908, &#39;HD2&#39;: 1.459, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;VAL&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB&#39;: 1.487, &#39;CG1&#39;: 1.908, &#39;CG2&#39;: 1.908, &#39;HG11&#39;: 1.487, &#39;1HG2&#39;: 1.487, &#39;1HG1&#39;: 1.487, &#39;HG21&#39;: 1.487, &#39;HG12&#39;: 1.487, &#39;2HG1&#39;: 1.487, &#39;HG22&#39;: 1.487, &#39;2HG2&#39;: 1.487, &#39;HG13&#39;: 1.487, &#39;3HG2&#39;: 1.487, &#39;3HG1&#39;: 1.487, &#39;HG23&#39;: 1.487, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;HIS&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;HN&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;2HB&#39;: 1.487, &#39;1HB&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;HB1&#39;: 1.487, &#39;CG&#39;: 1.85, &#39;ND1&#39;: 1.75, &#39;HD1&#39;: 0.6, &#39;CE1&#39;: 1.85, &#39;HE1&#39;: 1.359, &#39;NE2&#39;: 1.75, &#39;CD2&#39;: 2.0, &#39;HD2&#39;: 1.409, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;PTR&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;CD1&#39;: 1.908, &#39;HD1&#39;: 1.459, &#39;CE1&#39;: 1.908, &#39;HE1&#39;: 1.459, &#39;CZ&#39;: 1.908, &#39;CE2&#39;: 1.908, &#39;HE2&#39;: 1.459, &#39;CD2&#39;: 1.908, &#39;HD2&#39;: 1.459, &#39;OH&#39;: 1.6837, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.85, &#39;O2P&#39;: 1.85, &#39;O3P&#39;: 1.85, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;SEP&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.387, &#39;HB3&#39;: 1.387, &#39;1HB&#39;: 1.387, &#39;2HB&#39;: 1.387, &#39;OG&#39;: 1.6837, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.85, &#39;O2P&#39;: 1.85, &#39;O3P&#39;: 1.85, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;TPO&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB&#39;: 1.387, &#39;CG2&#39;: 1.908, &#39;HG21&#39;: 1.487, &#39;HG22&#39;: 1.487, &#39;HG23&#39;: 1.487, &#39;1HG2&#39;: 1.487, &#39;2HG2&#39;: 1.487, &#39;3HG2&#39;: 1.487, &#39;OG1&#39;: 1.6837, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.85, &#39;O2P&#39;: 1.85, &#39;O3P&#39;: 1.85, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;H2D&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.85, &#39;ND1&#39;: 1.75, &#39;CE1&#39;: 1.85, &#39;HE1&#39;: 1.359, &#39;NE2&#39;: 1.75, &#39;HE2&#39;: 0.6, &#39;CD2&#39;: 2.0, &#39;HD2&#39;: 1.409, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.85, &#39;O2P&#39;: 1.85, &#39;O3P&#39;: 1.85, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;Y1P&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.487, &#39;HB3&#39;: 1.487, &#39;CG&#39;: 1.908, &#39;CD1&#39;: 1.908, &#39;HD1&#39;: 1.459, &#39;CE1&#39;: 1.908, &#39;HE1&#39;: 1.459, &#39;CZ&#39;: 1.908, &#39;CE2&#39;: 1.908, &#39;HE2&#39;: 1.459, &#39;CD2&#39;: 1.908, &#39;HD2&#39;: 1.459, &#39;OG&#39;: 1.6837, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.721, &#39;O2P&#39;: 1.6612, &#39;O3P&#39;: 1.6612, &#39;H1P&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;T1P&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB&#39;: 1.387, &#39;CG2&#39;: 1.908, &#39;HG21&#39;: 1.487, &#39;HG22&#39;: 1.487, &#39;HG23&#39;: 1.487, &#39;OG&#39;: 1.6837, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.721, &#39;O2P&#39;: 1.6612, &#39;O3P&#39;: 1.6612, &#39;H1P&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;S1P&#39;: {&#39;N&#39;: 1.824, &#39;H&#39;: 0.6, &#39;CA&#39;: 1.908, &#39;HA&#39;: 1.387, &#39;CB&#39;: 1.908, &#39;HB2&#39;: 1.387, &#39;HB3&#39;: 1.387, &#39;OG&#39;: 1.6837, &#39;P&#39;: 2.1, &#39;O1P&#39;: 1.721, &#39;O2P&#39;: 1.6612, &#39;O3P&#39;: 1.6612, &#39;H1P&#39;: 0.0001, &#39;C&#39;: 1.908, &#39;O&#39;: 1.6612}, &#39;GEN&#39;: {&#39;AC&#39;: 2.0, &#39;AG&#39;: 1.72, &#39;AL&#39;: 2.0, &#39;AM&#39;: 2.0, &#39;AR&#39;: 1.88, &#39;AS&#39;: 1.85, &#39;AT&#39;: 2.0, &#39;AU&#39;: 1.66, &#39;B&#39;: 2.0, &#39;BA&#39;: 2.0, &#39;BE&#39;: 2.0, &#39;BH&#39;: 2.0, &#39;BI&#39;: 2.0, &#39;BK&#39;: 2.0, &#39;BR&#39;: 1.85, &#39;C&#39;: 1.66, &#39;CA&#39;: 2.0, &#39;CD&#39;: 1.58, &#39;CE&#39;: 2.0, &#39;CF&#39;: 2.0, &#39;CL&#39;: 1.75, &#39;CM&#39;: 2.0, &#39;CO&#39;: 2.0, &#39;CR&#39;: 2.0, &#39;CS&#39;: 2.0, &#39;CU&#39;: 1.4, &#39;DB&#39;: 2.0, &#39;DS&#39;: 2.0, &#39;DY&#39;: 2.0, &#39;ER&#39;: 2.0, &#39;ES&#39;: 2.0, &#39;EU&#39;: 2.0, &#39;F&#39;: 1.47, &#39;FE&#39;: 2.0, &#39;FM&#39;: 2.0, &#39;FR&#39;: 2.0, &#39;GA&#39;: 1.87, &#39;GD&#39;: 2.0, &#39;GE&#39;: 2.0, &#39;H&#39;: 0.91, &#39;HE&#39;: 1.4, &#39;HF&#39;: 2.0, &#39;HG&#39;: 1.55, &#39;HO&#39;: 2.0, &#39;HS&#39;: 2.0, &#39;I&#39;: 1.98, &#39;IN&#39;: 1.93, &#39;IR&#39;: 2.0, &#39;K&#39;: 2.75, &#39;KR&#39;: 2.02, &#39;LA&#39;: 2.0, &#39;LI&#39;: 1.82, &#39;LR&#39;: 2.0, &#39;LU&#39;: 2.0, &#39;MD&#39;: 2.0, &#39;MG&#39;: 1.73, &#39;MN&#39;: 2.0, &#39;MO&#39;: 2.0, &#39;MT&#39;: 2.0, &#39;N&#39;: 1.97, &#39;NA&#39;: 2.27, &#39;NB&#39;: 2.0, &#39;ND&#39;: 2.0, &#39;NE&#39;: 1.54, &#39;NI&#39;: 1.63, &#39;NO&#39;: 2.0, &#39;NP&#39;: 2.0, &#39;O&#39;: 1.69, &#39;OS&#39;: 2.0, &#39;P&#39;: 2.1, &#39;PA&#39;: 2.0, &#39;PB&#39;: 2.02, &#39;PD&#39;: 1.63, &#39;PM&#39;: 2.0, &#39;PO&#39;: 2.0, &#39;PR&#39;: 2.0, &#39;PT&#39;: 1.72, &#39;PU&#39;: 2.0, &#39;RA&#39;: 2.0, &#39;RB&#39;: 2.0, &#39;RE&#39;: 2.0, &#39;RF&#39;: 2.0, &#39;RH&#39;: 2.0, &#39;RN&#39;: 2.0, &#39;RU&#39;: 2.0, &#39;S&#39;: 2.09, &#39;SB&#39;: 2.0, &#39;SC&#39;: 2.0, &#39;SE&#39;: 1.9, &#39;SG&#39;: 2.0, &#39;SI&#39;: 2.1, &#39;SM&#39;: 2.0, &#39;SN&#39;: 2.17, &#39;SR&#39;: 2.0, &#39;TA&#39;: 2.0, &#39;TB&#39;: 2.0, &#39;TC&#39;: 2.0, &#39;TE&#39;: 2.06, &#39;TH&#39;: 2.0, &#39;TI&#39;: 2.0, &#39;TL&#39;: 1.96, &#39;TM&#39;: 2.0, &#39;U&#39;: 1.86, &#39;V&#39;: 2.0, &#39;W&#39;: 2.0, &#39;XE&#39;: 2.16, &#39;Y&#39;: 2.0, &#39;YB&#39;: 2.0, &#39;ZN&#39;: 1.39, &#39;ZR&#39;: 2.0}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function takes the <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/vdw.dat">built-in dictionary</a> when a <em>.dat</em> file is not specified. Otherwise, user must specify a <em>.dat</em> file following template of <a class="reference external" href="../_cfg_files/vdw_file_template.html">van der Waals radii file</a>.</p>
<p>This step is only necessary if you are reading a custom van der Waals radii file to use in <code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_pdb</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/read_vdw.html">pyKVFinder.read_vdw</a></p></li>
</ul>
</div>
</section>
<section id="loading-data-from-target-structure">
<h4>2. Loading data from target structure<a class="headerlink" href="#loading-data-from-target-structure" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_pdb</span></code> takes a target <em>.pdb</em> file and returns a NumPy array (<code class="docutils literal notranslate"><span class="pre">atomic</span></code>) with residue number, chain identifier, residue name, atom name, xyz coordinates and radius, considering a van der Waals radii dictionary, for each atom.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;1FMO.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomic</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atomic</span>
<span class="go">array([[&#39;13&#39;, &#39;E&#39;, &#39;GLU&#39;, ..., &#39;-15.642&#39;, &#39;-14.858&#39;, &#39;1.824&#39;],</span>
<span class="go">     [&#39;13&#39;, &#39;E&#39;, &#39;GLU&#39;, ..., &#39;-14.62&#39;, &#39;-15.897&#39;, &#39;1.908&#39;],</span>
<span class="go">     [&#39;13&#39;, &#39;E&#39;, &#39;GLU&#39;, ..., &#39;-13.357&#39;, &#39;-15.508&#39;, &#39;1.908&#39;],</span>
<span class="go">     ...,</span>
<span class="go">     [&#39;350&#39;, &#39;E&#39;, &#39;PHE&#39;, ..., &#39;18.878&#39;, &#39;-9.885&#39;, &#39;1.908&#39;],</span>
<span class="go">     [&#39;350&#39;, &#39;E&#39;, &#39;PHE&#39;, ..., &#39;17.624&#39;, &#39;-9.558&#39;, &#39;1.908&#39;],</span>
<span class="go">     [&#39;350&#39;, &#39;E&#39;, &#39;PHE&#39;, ..., &#39;19.234&#39;, &#39;-13.442&#39;, &#39;1.69&#39;]],</span>
<span class="go">    dtype=&#39;&lt;U32&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function takes the <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/vdw.dat">built-in dictionary</a>, when the <code class="docutils literal notranslate"><span class="pre">vdw</span></code> argument is not specified. If you wish to use a custom van der Waals radii file, you must read it with <code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_vdw</span></code> as shown earlier and pass it as <code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_pdb(pdb,</span> <span class="pre">vdw=vdw)</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The structural data can be also read from a <em>.xyz</em> file with <code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_xyz</span></code> function. However, XYZ format does not provide information about chain identifier and residue name, thus this fields will have <cite>A</cite> and <cite>UNK</cite>, respectively.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/read_pdb.html">pyKVFinder.read_pdb</a></p></li>
<li><p><a class="reference external" href="../api_reference/read_xyz.html">pyKVFinder.read_xyz</a></p></li>
</ul>
</div>
</section>
<section id="dimensioning-the-3d-grid">
<h4>3. Dimensioning the 3D grid<a class="headerlink" href="#dimensioning-the-3d-grid" title="Link to this heading"></a></h4>
<p>The pyKVFinder 3D grid must be calculated based on the target <em>.pdb</em> or <em>.xyz</em> file, the Probe Out diameter and the grid spacing.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.get_vertices</span></code> takes the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom, and the Probe Out (<code class="docutils literal notranslate"><span class="pre">probe_out</span></code>) and grid spacing (<code class="docutils literal notranslate"><span class="pre">step</span></code>) that will be applied in the detection, and returns a NumPy array with vertice coordinates (origin, X-axis, Y-axis, Z-axis) of the 3D grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Probe Out (probe_out): 4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe_out</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Grid Spacing (step): 0.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vertices</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">get_vertices</span><span class="p">(</span><span class="n">atomic</span><span class="p">,</span> <span class="n">probe_out</span><span class="o">=</span><span class="n">probe_out</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vertices</span>
<span class="go">array([[-19.911, -32.125, -30.806],</span>
<span class="go">     [ 40.188, -32.125, -30.806],</span>
<span class="go">     [-19.911,  43.446, -30.806],</span>
<span class="go">     [-19.911, -32.125,  27.352]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">probe_out</span></code> and <code class="docutils literal notranslate"><span class="pre">step</span></code> values are not defined, the function automatically sets them to the default values. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.get_vertices(atomic)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/get_vertices.html">pyKVFinder.get_vertices</a></p></li>
</ul>
</div>
</section>
<section id="detecting-biomolecular-cavities">
<h4>4. Detecting biomolecular cavities<a class="headerlink" href="#detecting-biomolecular-cavities" title="Link to this heading"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.detect</span></code> takes the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom, a NumPy array with vertices and a collection of detection parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_out</span></code>, <code class="docutils literal notranslate"><span class="pre">removal_distance</span></code>, <code class="docutils literal notranslate"><span class="pre">volume_cutoff</span></code>, <code class="docutils literal notranslate"><span class="pre">surface</span></code>), and returns a tuple with the number of detected cavities and a NumPy array with the cavity points in the 3D grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Grid Spacing (step): 0.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Probe In (probe_in): 1.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe_in</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Probe Out (probe_out): 4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe_out</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Removal Distance (removal_distance): 2.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">removal_distance</span> <span class="o">=</span> <span class="mf">2.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Volume Cutoff (volume_cutoff): 5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">volume_cutoff</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Surface Representation (surface): &#39;SES&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span> <span class="o">=</span> <span class="s1">&#39;SES&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncav</span><span class="p">,</span> <span class="n">cavities</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">atomic</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe_in</span><span class="o">=</span><span class="n">probe_in</span><span class="p">,</span> <span class="n">probe_out</span><span class="o">=</span><span class="n">probe_out</span><span class="p">,</span> <span class="n">removal_distance</span><span class="o">=</span><span class="n">removal_distance</span><span class="p">,</span> <span class="n">volume_cutoff</span><span class="o">=</span><span class="n">volume_cutoff</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncav</span>
<span class="go">18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cavities</span>
<span class="go">array([[[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      ...,</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1]],</span>

<span class="go">     ...,</span>

<span class="go">     [[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      ...,</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1]]], dtype=int32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of the detection parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_out</span></code>, <code class="docutils literal notranslate"><span class="pre">removal_distance</span></code>, <code class="docutils literal notranslate"><span class="pre">volume_cutoff</span></code>, <code class="docutils literal notranslate"><span class="pre">surface</span></code>) are not defined, the function automatically sets them to the default values. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.detect(atomic,</span> <span class="pre">vertices)</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity points belonging to the same cavity receive the same integer label in the grid. The code numbering is the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>-1: bulk points.</p></li>
<li><p>0: biomolecule points.</p></li>
<li><p>1: empty space points.</p></li>
<li><p>&gt;=2: cavity points.</p></li>
</ul>
</div></blockquote>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/detect.html">pyKVFinder.detect</a></p></li>
</ul>
</div>
</section>
<section id="detecting-biomolecular-cavities-with-ligand-adjustment">
<h4>4.1 Detecting biomolecular cavities with ligand adjustment<a class="headerlink" href="#detecting-biomolecular-cavities-with-ligand-adjustment" title="Link to this heading"></a></h4>
<p>The cavity detection can be limited around the target ligand(s), which will be passed to pyKVFinder through a <em>.pdb</em> or <em>.xyz</em> file. Thus, the detected cavities are limited within a radius (<code class="docutils literal notranslate"><span class="pre">ligand_cutoff</span></code>) of the target ligand(s).</p>
<p>First, <code class="docutils literal notranslate"><span class="pre">pyKVFinder.read_pdb</span></code> takes an <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/tests/data/ADN.pdb">adenosine</a> as the target ligand and returns the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom of the ligand.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ligand</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;ADN.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latomic</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">read_pdb</span><span class="p">(</span><span class="n">ligand</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">latomic</span>
<span class="go">array([[&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;C5&#39;&quot;, &#39;11.087&#39;, &#39;9.79&#39;, &#39;2.052&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;O5&#39;&quot;, &#39;11.545&#39;, &#39;8.52&#39;, &#39;1.545&#39;, &#39;1.69&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;C4&#39;&quot;, &#39;10.688&#39;, &#39;9.68&#39;, &#39;3.523&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;O4&#39;&quot;, &#39;9.714&#39;, &#39;10.725&#39;, &#39;3.81&#39;, &#39;1.69&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;C3&#39;&quot;, &#39;9.973&#39;, &#39;8.374&#39;, &#39;3.903&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;O3&#39;&quot;, &#39;10.879&#39;, &#39;7.361&#39;, &#39;4.304&#39;, &#39;1.69&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;C2&#39;&quot;, &#39;9.115&#39;, &#39;8.82&#39;, &#39;5.059&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;O2&#39;&quot;, &#39;9.887&#39;, &#39;9.034&#39;, &#39;6.232&#39;, &#39;1.69&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &quot;C1&#39;&quot;, &#39;8.625&#39;, &#39;10.16&#39;, &#39;4.5&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;N1&#39;, &#39;3.499&#39;, &#39;10.104&#39;, &#39;4.402&#39;, &#39;1.97&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;C2&#39;, &#39;4.376&#39;, &#39;10.259&#39;, &#39;5.387&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;N3&#39;, &#39;5.705&#39;, &#39;10.249&#39;, &#39;5.351&#39;, &#39;1.97&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;C4&#39;, &#39;6.136&#39;, &#39;10.087&#39;, &#39;4.094&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;C5&#39;, &#39;5.353&#39;, &#39;9.952&#39;, &#39;2.974&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;C6&#39;, &#39;3.957&#39;, &#39;9.957&#39;, &#39;3.146&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;N6&#39;, &#39;3.083&#39;, &#39;9.826&#39;, &#39;2.142&#39;, &#39;1.97&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;N7&#39;, &#39;6.146&#39;, &#39;9.791&#39;, &#39;1.843&#39;, &#39;1.97&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;C8&#39;, &#39;7.374&#39;, &#39;9.872&#39;, &#39;2.291&#39;, &#39;1.66&#39;],</span>
<span class="go">     [&#39;351&#39;, &#39;E&#39;, &#39;ADN&#39;, &#39;N9&#39;, &#39;7.444&#39;, &#39;10.056&#39;, &#39;3.646&#39;, &#39;1.97&#39;]],</span>
<span class="go">    dtype=&#39;&lt;U32&#39;)</span>
</pre></div>
</div>
<p>Afterwards, <code class="docutils literal notranslate"><span class="pre">parKVFinder.detect</span></code> takes the mandatory parameters (<code class="docutils literal notranslate"><span class="pre">atomic</span></code> and <code class="docutils literal notranslate"><span class="pre">vertices</span></code>) and a the ligand adjustment parameters (<code class="docutils literal notranslate"><span class="pre">latomic</span></code> and <code class="docutils literal notranslate"><span class="pre">ligand_cutoff</span></code>), and returns a tuple with the number of detected cavities and a NumPy array with the cavity points in the 3D grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Ligand Cutoff (ligand_cutoff): 5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ligand_cutoff</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncav_la</span><span class="p">,</span> <span class="n">cavities_la</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">atomic</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">latomic</span><span class="o">=</span><span class="n">latomic</span><span class="p">,</span> <span class="n">ligand_cutoff</span><span class="o">=</span><span class="n">ligand_cutoff</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncav_la</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cavities_la</span>
<span class="go">array([[[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      ...,</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1]],</span>

<span class="go">     ...,</span>

<span class="go">     [[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      ...,</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1]]], dtype=int32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">ligand_cutoff</span></code> is not defined, the function automatically sets it to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.detect(atomic,</span> <span class="pre">vertices,</span> <span class="pre">latomic=latomic)</span></code>.</p>
<p>The cavity points belonging to the same cavity receive the same integer label in the grid. The code numbering is the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>-1: bulk points.</p></li>
<li><p>0: biomolecule points.</p></li>
<li><p>1: empty space points.</p></li>
<li><p>&gt;=2: cavity points.</p></li>
</ul>
</div></blockquote>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/read_pdb.html">pyKVFinder.read_pdb</a></p></li>
<li><p><a class="reference external" href="../api_reference/read_xyz.html">pyKVFinder.read_xyz</a></p></li>
<li><p><a class="reference external" href="../api_reference/detect.html">pyKVFinder.detect</a></p></li>
</ul>
</div>
</section>
<section id="performing-spatial-characterization">
<h4>5. Performing spatial characterization<a class="headerlink" href="#performing-spatial-characterization" title="Link to this heading"></a></h4>
<p>A spatial characterization, that includes volume, area and defining surface points, is performed on the detected cavities.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.spatial</span></code> takes the detected cavities and the grid spacing (<code class="docutils literal notranslate"><span class="pre">step</span></code>) and and returns a tuple with a NumPy array with the surface points in the 3D grid, a dictionary with the volume of the detected cavities and a dictionary with the area of the detected cavities.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="p">,</span> <span class="n">volume</span><span class="p">,</span> <span class="n">area</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">spatial</span><span class="p">(</span><span class="n">cavities</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span>
<span class="go">array([[[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      ...,</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1]],</span>

<span class="go">     ...,</span>

<span class="go">     [[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      ...,</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">      [-1, -1, -1, ..., -1, -1, -1]]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">volume</span>
<span class="go">{&#39;KAA&#39;: 137.16, &#39;KAB&#39;: 47.52, &#39;KAC&#39;: 66.96, &#39;KAD&#39;: 8.21, &#39;KAE&#39;: 43.63, &#39;KAF&#39;: 12.53, &#39;KAG&#39;: 6.26, &#39;KAH&#39;: 520.13, &#39;KAI&#39;: 12.31, &#39;KAJ&#39;: 26.57, &#39;KAK&#39;: 12.31, &#39;KAL&#39;: 33.91, &#39;KAM&#39;: 23.11, &#39;KAN&#39;: 102.82, &#39;KAO&#39;: 6.05, &#39;KAP&#39;: 15.55, &#39;KAQ&#39;: 7.99, &#39;KAR&#39;: 7.78}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span>
<span class="go">{&#39;KAA&#39;: 126.41, &#39;KAB&#39;: 62.37, &#39;KAC&#39;: 74.57, &#39;KAD&#39;: 19.06, &#39;KAE&#39;: 57.08, &#39;KAF&#39;: 22.77, &#39;KAG&#39;: 15.38, &#39;KAH&#39;: 496.97, &#39;KAI&#39;: 30.58, &#39;KAJ&#39;: 45.64, &#39;KAK&#39;: 30.58, &#39;KAL&#39;: 45.58, &#39;KAM&#39;: 45.25, &#39;KAN&#39;: 129.77, &#39;KAO&#39;: 12.28, &#39;KAP&#39;: 25.04, &#39;KAQ&#39;: 13.46, &#39;KAR&#39;: 16.6}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The surface points belonging to the same cavity receive the same integer label in the grid. The code numbering is the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>-1: bulk points.</p></li>
<li><p>0: biomolecule or empty space points.</p></li>
<li><p>&gt;=2: cavity points.</p></li>
</ul>
</div></blockquote>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">step</span></code> is not defined, the function automatically sets it to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.spatial(cavities)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/spatial.html">pyKVFinder.spatial</a></p></li>
</ul>
</div>
</section>
<section id="performing-constitutional-characterization">
<h4>6. Performing constitutional characterization<a class="headerlink" href="#performing-constitutional-characterization" title="Link to this heading"></a></h4>
<p>A constitutional characterization, that identifies the interface residues, is performed on the detected cavities.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.constitutional</span></code> takes the detected cavities, the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom, the NumPy array with vertice coordinates (origin, X-axis, Y-axis, Z-axis) and a collection of detection parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code>, <code class="docutils literal notranslate"><span class="pre">ignore_backbone</span></code>), and returns a dictionary with interface residues of each cavity.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default ignore backbone contacts flag (ignore_backbone): False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignore_backbone</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">constitutional</span><span class="p">(</span><span class="n">cavities</span><span class="p">,</span> <span class="n">atomic</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe_in</span><span class="o">=</span><span class="n">probe_in</span><span class="p">,</span> <span class="n">ignore_backbone</span><span class="o">=</span><span class="n">ignore_backbone</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span>
<span class="go">{&#39;KAA&#39;: [[&#39;14&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;15&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;18&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;19&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;100&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;152&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;155&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;156&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;292&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;302&#39;, &#39;E&#39;, &#39;TRP&#39;], [&#39;303&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;306&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAB&#39;: [[&#39;18&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;22&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;25&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;26&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;29&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;97&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;98&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;99&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;156&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAC&#39;: [[&#39;141&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;142&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;144&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;145&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;148&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;299&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;300&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;305&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;310&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;311&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;313&#39;, &#39;E&#39;, &#39;PRO&#39;]], &#39;KAD&#39;: [[&#39;122&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;124&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;176&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;318&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;320&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;321&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;322&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;323&#39;, &#39;E&#39;, &#39;ASP&#39;]], &#39;KAE&#39;: [[&#39;95&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;98&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;99&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;100&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;103&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;104&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;105&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;106&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAF&#39;: [[&#39;123&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;124&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;175&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;176&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;181&#39;, &#39;E&#39;, &#39;GLN&#39;]], &#39;KAG&#39;: [[&#39;34&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;37&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;96&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;106&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;107&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;108&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;109&#39;, &#39;E&#39;, &#39;SER&#39;]], &#39;KAH&#39;: [[&#39;49&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;50&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;52&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;53&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;54&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;55&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;57&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;70&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;72&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;74&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;84&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;87&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;88&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;91&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;104&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;120&#39;, &#39;E&#39;, &#39;MET&#39;], [&#39;121&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;122&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;123&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;127&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;166&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;168&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;170&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;171&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;173&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;183&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;184&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;186&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;187&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;201&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;327&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAI&#39;: [[&#39;131&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;138&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;142&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;146&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;174&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;314&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAJ&#39;: [[&#39;33&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;89&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;92&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;93&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;96&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;349&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;350&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAK&#39;: [[&#39;157&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;162&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;163&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;164&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;185&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;188&#39;, &#39;E&#39;, &#39;ALA&#39;]], &#39;KAL&#39;: [[&#39;49&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;127&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;129&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;130&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;326&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;327&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;328&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;330&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAM&#39;: [[&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;55&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;73&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;74&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;75&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;115&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;335&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;336&#39;, &#39;E&#39;, &#39;ARG&#39;]], &#39;KAN&#39;: [[&#39;165&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;166&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;167&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;199&#39;, &#39;E&#39;, &#39;CYS&#39;], [&#39;200&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;201&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;204&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;205&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;206&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;209&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;219&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;220&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;223&#39;, &#39;E&#39;, &#39;ALA&#39;]], &#39;KAO&#39;: [[&#39;48&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;330&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;331&#39;, &#39;E&#39;, &#39;GLU&#39;]], &#39;KAP&#39;: [[&#39;222&#39;, &#39;E&#39;, &#39;TRP&#39;], [&#39;238&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;253&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;254&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;255&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;273&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAQ&#39;: [[&#39;207&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;208&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;211&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;213&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;275&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;277&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAR&#39;: [[&#39;237&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;238&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;249&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;254&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;255&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;256&#39;, &#39;E&#39;, &#39;ARG&#39;]]}</span>
</pre></div>
</div>
<p>If you wish to ignore backbones contacts (C, CA, N, O) with the cavity when defining interface residues, you must set <code class="docutils literal notranslate"><span class="pre">ignore_backbone</span></code> flag to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">residues_ib</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">constitutional</span><span class="p">(</span><span class="n">cavities</span><span class="p">,</span> <span class="n">atomic</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe_in</span><span class="o">=</span><span class="n">probe_in</span><span class="p">,</span> <span class="n">ignore_backbone</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues_ib</span>
<span class="go">{&#39;KAA&#39;: [[&#39;15&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;18&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;19&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;100&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;152&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;155&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;156&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;292&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;302&#39;, &#39;E&#39;, &#39;TRP&#39;], [&#39;303&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;306&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAB&#39;: [[&#39;18&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;22&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;25&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;26&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;29&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;99&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;156&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAC&#39;: [[&#39;144&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;145&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;148&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;299&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;300&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;305&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;310&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;311&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;313&#39;, &#39;E&#39;, &#39;PRO&#39;]], &#39;KAD&#39;: [[&#39;122&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;124&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;176&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;318&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAE&#39;: [[&#39;98&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;99&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;103&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;105&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;106&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAF&#39;: [[&#39;123&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;175&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;181&#39;, &#39;E&#39;, &#39;GLN&#39;]], &#39;KAG&#39;: [[&#39;34&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;37&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;96&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;106&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;109&#39;, &#39;E&#39;, &#39;SER&#39;]], &#39;KAH&#39;: [[&#39;49&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;53&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;54&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;57&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;70&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;72&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;74&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;84&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;87&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;88&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;91&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;104&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;120&#39;, &#39;E&#39;, &#39;MET&#39;], [&#39;122&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;123&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;127&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;166&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;168&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;170&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;171&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;173&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;183&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;184&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;187&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;201&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;327&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAI&#39;: [[&#39;131&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;138&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;142&#39;, &#39;E&#39;, &#39;HIS&#39;], [&#39;146&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;174&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;314&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAJ&#39;: [[&#39;33&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;89&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;92&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;93&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;96&#39;, &#39;E&#39;, &#39;GLN&#39;], [&#39;349&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;350&#39;, &#39;E&#39;, &#39;PHE&#39;]], &#39;KAK&#39;: [[&#39;157&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;162&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;164&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;185&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;188&#39;, &#39;E&#39;, &#39;ALA&#39;]], &#39;KAL&#39;: [[&#39;127&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;129&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;130&#39;, &#39;E&#39;, &#39;SER&#39;], [&#39;327&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;328&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;330&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAM&#39;: [[&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;73&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;115&#39;, &#39;E&#39;, &#39;ASN&#39;], [&#39;335&#39;, &#39;E&#39;, &#39;ILE&#39;]], &#39;KAN&#39;: [[&#39;165&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;166&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;167&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;201&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;204&#39;, &#39;E&#39;, &#39;TYR&#39;], [&#39;205&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;206&#39;, &#39;E&#39;, &#39;ALA&#39;], [&#39;209&#39;, &#39;E&#39;, &#39;ILE&#39;], [&#39;219&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;220&#39;, &#39;E&#39;, &#39;ASP&#39;], [&#39;223&#39;, &#39;E&#39;, &#39;ALA&#39;]], &#39;KAO&#39;: [[&#39;48&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;], [&#39;56&#39;, &#39;E&#39;, &#39;ARG&#39;], [&#39;330&#39;, &#39;E&#39;, &#39;TYR&#39;]], &#39;KAP&#39;: [[&#39;222&#39;, &#39;E&#39;, &#39;TRP&#39;], [&#39;238&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;255&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;273&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAQ&#39;: [[&#39;207&#39;, &#39;E&#39;, &#39;PRO&#39;], [&#39;208&#39;, &#39;E&#39;, &#39;GLU&#39;], [&#39;211&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;213&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;277&#39;, &#39;E&#39;, &#39;LEU&#39;]], &#39;KAR&#39;: [[&#39;238&#39;, &#39;E&#39;, &#39;PHE&#39;], [&#39;249&#39;, &#39;E&#39;, &#39;LYS&#39;], [&#39;255&#39;, &#39;E&#39;, &#39;VAL&#39;], [&#39;256&#39;, &#39;E&#39;, &#39;ARG&#39;]]}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code> and <code class="docutils literal notranslate"><span class="pre">ignore_backbone</span></code> are not defined, the function automatically sets them to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.constitutional(cavities,</span> <span class="pre">atomic,</span> <span class="pre">vertices)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/constitutional.html">pyKVFinder.constitutional</a></p></li>
</ul>
</div>
</section>
<section id="calculating-and-plotting-frequencies">
<h4>6.1 Calculating and plotting frequencies<a class="headerlink" href="#calculating-and-plotting-frequencies" title="Link to this heading"></a></h4>
<p>With the interface residues defined, you can also calculate the frequencies of residues and classes of residues. The classes of residues are:</p>
<dl class="field-list simple">
<dt class="field-odd">R1<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Alipathic apolar:</strong> Alanine, Glycine, Isoleucine, Leucine, Methionine, Valine</p>
</dd>
<dt class="field-even">R2<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Aromatic:</strong> Phenylalanine, Tryptophan, Tyrosine</p>
</dd>
<dt class="field-odd">R3<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Polar uncharged</strong>: Asparagine, Cysteine, Glutamine, Proline, Serine, Threonine</p>
</dd>
<dt class="field-even">R4<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Negatively charged</strong>: Aspartate, Glutamate</p>
</dd>
<dt class="field-odd">R5<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Positively charged</strong>: Arginine, Histidine, Lysine</p>
</dd>
<dt class="field-even">RX<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Non-standard</strong>: Non-standard residues</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.calculate_frequencies</span></code> takes the dictionary of interface residues calculated above and returns a dictionary with the frequencies of residues and classes of residues of each detected cavity.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">frequencies</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">calculate_frequencies</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frequencies</span>
<span class="go">{&#39;KAA&#39;: {&#39;RESIDUES&#39;: {&#39;GLU&#39;: 1, &#39;ILE&#39;: 1, &#39;LEU&#39;: 2, &#39;LYS&#39;: 1, &#39;PHE&#39;: 2, &#39;SER&#39;: 1, &#39;TRP&#39;: 1, &#39;TYR&#39;: 2, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 5, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAB&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 2, &#39;ASN&#39;: 1, &#39;ASP&#39;: 1, &#39;LYS&#39;: 1, &#39;PHE&#39;: 2, &#39;TYR&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 3, &#39;R2&#39;: 3, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAC&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ARG&#39;: 1, &#39;GLU&#39;: 1, &#39;HIS&#39;: 1, &#39;ILE&#39;: 1, &#39;PHE&#39;: 1, &#39;PRO&#39;: 2, &#39;THR&#39;: 2, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 5, &#39;R2&#39;: 1, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAD&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ASP&#39;: 1, &#39;GLN&#39;: 1, &#39;GLY&#39;: 2, &#39;PHE&#39;: 1, &#39;PRO&#39;: 1, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 2, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAE&#39;: {&#39;RESIDUES&#39;: {&#39;ASN&#39;: 1, &#39;LEU&#39;: 3, &#39;LYS&#39;: 1, &#39;PHE&#39;: 1, &#39;VAL&#39;: 2}, &#39;CLASS&#39;: {&#39;R1&#39;: 5, &#39;R2&#39;: 1, &#39;R3&#39;: 1, &#39;R4&#39;: 0, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAF&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ASP&#39;: 1, &#39;GLN&#39;: 2, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 2, &#39;R2&#39;: 0, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAG&#39;: {&#39;RESIDUES&#39;: {&#39;GLN&#39;: 1, &#39;GLU&#39;: 1, &#39;LEU&#39;: 1, &#39;PHE&#39;: 1, &#39;SER&#39;: 2, &#39;THR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 1, &#39;R2&#39;: 1, &#39;R3&#39;: 4, &#39;R4&#39;: 1, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAH&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ARG&#39;: 1, &#39;ASN&#39;: 1, &#39;ASP&#39;: 2, &#39;GLN&#39;: 1, &#39;GLU&#39;: 4, &#39;GLY&#39;: 4, &#39;HIS&#39;: 1, &#39;LEU&#39;: 3, &#39;LYS&#39;: 2, &#39;MET&#39;: 1, &#39;PHE&#39;: 3, &#39;SER&#39;: 1, &#39;THR&#39;: 4, &#39;TYR&#39;: 1, &#39;VAL&#39;: 3}, &#39;CLASS&#39;: {&#39;R1&#39;: 11, &#39;R2&#39;: 4, &#39;R3&#39;: 8, &#39;R4&#39;: 6, &#39;R5&#39;: 4, &#39;RX&#39;: 0}}, &#39;KAI&#39;: {&#39;RESIDUES&#39;: {&#39;HIS&#39;: 2, &#39;ILE&#39;: 1, &#39;PHE&#39;: 2, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 1, &#39;R2&#39;: 3, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAJ&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 1, &#39;GLN&#39;: 1, &#39;GLU&#39;: 1, &#39;LEU&#39;: 1, &#39;LYS&#39;: 1, &#39;PHE&#39;: 1, &#39;PRO&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 2, &#39;R2&#39;: 1, &#39;R3&#39;: 1, &#39;R4&#39;: 1, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAK&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 1, &#39;ILE&#39;: 1, &#39;LEU&#39;: 2, &#39;PHE&#39;: 1, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 2, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAL&#39;: {&#39;RESIDUES&#39;: {&#39;ASN&#39;: 1, &#39;ASP&#39;: 1, &#39;GLU&#39;: 1, &#39;LEU&#39;: 1, &#39;PHE&#39;: 2, &#39;SER&#39;: 1, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 1, &#39;R2&#39;: 3, &#39;R3&#39;: 2, &#39;R4&#39;: 2, &#39;R5&#39;: 0, &#39;RX&#39;: 0}}, &#39;KAM&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 2, &#39;ASN&#39;: 1, &#39;ASP&#39;: 1, &#39;GLY&#39;: 1, &#39;ILE&#39;: 2, &#39;LEU&#39;: 1, &#39;THR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 0, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 2, &#39;RX&#39;: 0}}, &#39;KAN&#39;: {&#39;RESIDUES&#39;: {&#39;ALA&#39;: 2, &#39;ARG&#39;: 1, &#39;ASP&#39;: 2, &#39;CYS&#39;: 1, &#39;GLY&#39;: 1, &#39;ILE&#39;: 1, &#39;LEU&#39;: 2, &#39;THR&#39;: 1, &#39;TYR&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 7, &#39;R2&#39;: 1, &#39;R3&#39;: 2, &#39;R4&#39;: 2, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAO&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 1, &#39;GLU&#39;: 1, &#39;THR&#39;: 2, &#39;TYR&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 0, &#39;R2&#39;: 1, &#39;R3&#39;: 2, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAP&#39;: {&#39;RESIDUES&#39;: {&#39;GLY&#39;: 1, &#39;LEU&#39;: 1, &#39;LYS&#39;: 1, &#39;PHE&#39;: 1, &#39;TRP&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 3, &#39;R2&#39;: 2, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAQ&#39;: {&#39;RESIDUES&#39;: {&#39;GLU&#39;: 1, &#39;LEU&#39;: 2, &#39;LYS&#39;: 1, &#39;PRO&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 4, &#39;R2&#39;: 0, &#39;R3&#39;: 0, &#39;R4&#39;: 1, &#39;R5&#39;: 1, &#39;RX&#39;: 0}}, &#39;KAR&#39;: {&#39;RESIDUES&#39;: {&#39;ARG&#39;: 1, &#39;LYS&#39;: 2, &#39;PHE&#39;: 1, &#39;PRO&#39;: 1, &#39;VAL&#39;: 1}, &#39;CLASS&#39;: {&#39;R1&#39;: 2, &#39;R2&#39;: 1, &#39;R3&#39;: 0, &#39;R4&#39;: 0, &#39;R5&#39;: 3, &#39;RX&#39;: 0}}}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<p>Afterwards, <code class="docutils literal notranslate"><span class="pre">pyKVFinder.plot_frequencies</span></code> takes the dictionary with the frequencies of residues and classes of residues of each detected cavity and a path to a PDF file, and plots the bar charts of calculated frequencies for each detected cavity in a PDF file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="s1">&#39;barplots.pdf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">plot_frequencies</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">fn</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">fn</span></code> is not defined, the function automatically sets it to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.plot_frequencies(frequencies)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/calculate_frequencies.html">pyKVFinder.calculate_frequencies</a></p></li>
<li><p><a class="reference external" href="../api_reference/plot_frequencies.html">pyKVFinder.plot_frequencies</a></p></li>
</ul>
</div>
<p>A sample barplot of <code class="docutils literal notranslate"><span class="pre">pyKVFinder.plot_frequencies</span></code> is shown below.</p>
<a class="reference internal image-reference" href="../../_images/plot-frequencies.png"><img alt="../../_images/plot-frequencies.png" class="align-center" src="../../_images/plot-frequencies.png" style="width: 600px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="performing-hydropathy-characterization">
<h4>7. Performing hydropathy characterization<a class="headerlink" href="#performing-hydropathy-characterization" title="Link to this heading"></a></h4>
<p>A hydropathy characterization, that maps a target hydrophobicity scale on surface points and calculate the average hydropathy, is performed on the surface points of the detected cavities.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.hydropathy</span></code> takes the surface points of the detected cavities, the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom, the NumPy array with vertice coordinates (origin, X-axis, Y-axis, Z-axis), a collection of detection parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code>) and a target hydrophobicity scale to be mapped on the surface points, and returns a tuple with a NumPy array with the hydropobicity scale mapped to the surface points in the 3D grid and a dictionary with the average hydrophobicity scale of the detected cavities and the range of the chosen hydrophobicity scale.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Default Hydrophobicity Scale (hydropathy): &#39;EisenbergWeiss&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hydrophobicity_scale</span> <span class="o">=</span> <span class="s1">&#39;EisenbergWeiss&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales</span><span class="p">,</span> <span class="n">avg_hydropathy</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">hydropathy</span><span class="p">(</span><span class="n">surface</span><span class="p">,</span> <span class="n">atomic</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe_in</span><span class="o">=</span><span class="n">probe_in</span><span class="p">,</span> <span class="n">hydrophobicity_scale</span><span class="o">=</span><span class="n">hydrophobicity_scale</span><span class="p">,</span> <span class="n">ignore_backbone</span><span class="o">=</span><span class="n">ignore_backbone</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scales</span>
<span class="go">array([[[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      ...,</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.]],</span>

<span class="go">     ...,</span>

<span class="go">     [[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      ...,</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_hydropathy</span>
<span class="go">{&#39;KAA&#39;: -0.73, &#39;KAB&#39;: -0.05, &#39;KAC&#39;: -0.07, &#39;KAD&#39;: -0.62, &#39;KAE&#39;: -0.81, &#39;KAF&#39;: -0.14, &#39;KAG&#39;: -0.33, &#39;KAH&#39;: -0.16, &#39;KAI&#39;: -0.4, &#39;KAJ&#39;: 0.62, &#39;KAK&#39;: -0.99, &#39;KAL&#39;: 0.36, &#39;KAM&#39;: -0.33, &#39;KAN&#39;: 0.18, &#39;KAO&#39;: 0.88, &#39;KAP&#39;: -0.96, &#39;KAQ&#39;: 0.48, &#39;KAR&#39;: 0.24, &#39;EisenbergWeiss&#39;: [-1.42, 2.6]}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pyKVFinder.hydropathy</span></code> function accepts six built-in hydrophobicity scales:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/EisenbergWeiss.toml">EisenbergWeiss</a>;</p></li>
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/HessaHeijne.toml">HessaHeijne</a>;</p></li>
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/KyteDoolittle.toml">KyteDoolittle</a>;</p></li>
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/MoonFleming.toml">MoonFleming</a>;</p></li>
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/WimleyWhite.toml">WimleyWhite</a>;</p></li>
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/ZhaoLondon.toml">ZhaoLondon</a>.</p></li>
</ul>
</div></blockquote>
<p>Otherwise, user must specify a <em>.toml</em> file following <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder#hydrophobicity-scale-file-template">Hydrophobicity Scale File Template</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code>, <code class="docutils literal notranslate"><span class="pre">hydrophobicity_scale</span></code> and <code class="docutils literal notranslate"><span class="pre">ignore_backbone</span></code> are not defined, the function automatically sets them to the default values. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.hydropathy(surface,</span> <span class="pre">atomic,</span> <span class="pre">vertices)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/hydropathy.html">pyKVFinder.hydropathy</a></p></li>
</ul>
</div>
</section>
<section id="performing-depth-characterization">
<h4>8. Performing depth characterization<a class="headerlink" href="#performing-depth-characterization" title="Link to this heading"></a></h4>
<p>A depth characterization identifies the degree of burial of the binding site. First, it identifies the cavity volume boundary. Subsequently, the depth of each cavity point is heuristically estimated by the shortest Euclidean distance between the cavity point and its respective boundary points. With this, the maximum and average depths for the detected cavities are calculated.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.depth</span></code> takes the detected cavities and the grid spacing (<code class="docutils literal notranslate"><span class="pre">step</span></code>) and returns a tuple with a NumPy array with the depth of the cavity points in the 3D grid, a dictionary with the maximum depth of the detected cavities and a dictionary with the average depth of the detected cavities.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">depths</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">avg_depth</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">depth</span><span class="p">(</span><span class="n">cavities</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depths</span>
<span class="go">array([[[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      ...,</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.]],</span>

<span class="go">     ...,</span>

<span class="go">     [[0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      ...,</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.],</span>
<span class="go">      [0., 0., 0., ..., 0., 0., 0.]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_depth</span>
<span class="go">{&#39;KAA&#39;: 3.79, &#39;KAB&#39;: 2.68, &#39;KAC&#39;: 2.62, &#39;KAD&#39;: 0.85, &#39;KAE&#39;: 3.0, &#39;KAF&#39;: 0.85, &#39;KAG&#39;: 0.6, &#39;KAH&#39;: 10.73, &#39;KAI&#39;: 0.0, &#39;KAJ&#39;: 2.24, &#39;KAK&#39;: 0.0, &#39;KAL&#39;: 3.0, &#39;KAM&#39;: 1.2, &#39;KAN&#39;: 0.0, &#39;KAO&#39;: 1.04, &#39;KAP&#39;: 2.08, &#39;KAQ&#39;: 0.85, &#39;KAR&#39;: 0.6}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg_depth</span>
<span class="go">{&#39;KAA&#39;: 1.35, &#39;KAB&#39;: 0.91, &#39;KAC&#39;: 0.68, &#39;KAD&#39;: 0.32, &#39;KAE&#39;: 0.99, &#39;KAF&#39;: 0.24, &#39;KAG&#39;: 0.1, &#39;KAH&#39;: 3.91, &#39;KAI&#39;: 0.0, &#39;KAJ&#39;: 0.96, &#39;KAK&#39;: 0.0, &#39;KAL&#39;: 1.07, &#39;KAM&#39;: 0.24, &#39;KAN&#39;: 0.0, &#39;KAO&#39;: 0.29, &#39;KAP&#39;: 0.7, &#39;KAQ&#39;: 0.22, &#39;KAR&#39;: 0.12}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">step</span></code> is not defined, the function automatically sets it to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.depth(cavities)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/depth.html">pyKVFinder.depth</a></p></li>
</ul>
</div>
</section>
<section id="exporting-cavities">
<h4>9. Exporting cavities<a class="headerlink" href="#exporting-cavities" title="Link to this heading"></a></h4>
<p>There are four different ways to export the detected cavities to PDB-formatted files.</p>
<section id="exporting-only-cavity-points">
<h5>9.1 Exporting only cavity points<a class="headerlink" href="#exporting-only-cavity-points" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_cavity</span> <span class="o">=</span> <span class="s1">&#39;cavity_wo_surface.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">cavities</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exporting-cavity-and-surface-points">
<h5>9.2 Exporting cavity and surface points<a class="headerlink" href="#exporting-cavity-and-surface-points" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_cavity</span> <span class="o">=</span> <span class="s1">&#39;cavity.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">cavities</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exporting-cavity-and-surface-points-with-depth-mapped-on-b-factor">
<h5>9.3 Exporting cavity and surface points with depth mapped on B-factor<a class="headerlink" href="#exporting-cavity-and-surface-points-with-depth-mapped-on-b-factor" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_cavity</span> <span class="o">=</span> <span class="s1">&#39;cavity_with_depth.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">cavities</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">depths</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exporting-cavity-and-surface-points-with-depth-mapped-on-b-factor-and-hydrophobicity-scale-mapped-on-q-factor">
<h5>9.4 Exporting cavity and surface points with depth mapped on B-factor and hydrophobicity scale mapped on Q-factor<a class="headerlink" href="#exporting-cavity-and-surface-points-with-depth-mapped-on-b-factor-and-hydrophobicity-scale-mapped-on-q-factor" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_cavity</span> <span class="o">=</span> <span class="s1">&#39;cavity_with_depth.pdb&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">cavities</span><span class="p">,</span> <span class="n">surface</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="n">depths</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="n">scales</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code> and <code class="docutils literal notranslate"><span class="pre">scales</span></code> are not defined, the function automatically sets them to the default values. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.export(output_cavity,</span> <span class="pre">cavities,</span> <span class="pre">surface,</span> <span class="pre">vertices)</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/export.html">pyKVFinder.export</a></p></li>
</ul>
</div>
</section>
</section>
<section id="writing-results">
<h4>10.   Writing results<a class="headerlink" href="#writing-results" title="Link to this heading"></a></h4>
<p>The function call depends on the characterizations performed on the detected cavities.</p>
<section id="cavity-detection-only">
<h5>10.1 Cavity detection only<a class="headerlink" href="#cavity-detection-only" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_results</span> <span class="o">=</span> <span class="s1">&#39;results.toml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">write_results</span><span class="p">(</span><span class="n">output_results</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="n">pdb</span><span class="p">,</span> <span class="n">ligand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-characterization">
<h5>10.2 Spatial characterization<a class="headerlink" href="#spatial-characterization" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_results</span> <span class="o">=</span> <span class="s1">&#39;results.toml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">write_results</span><span class="p">(</span><span class="n">output_results</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="n">pdb</span><span class="p">,</span> <span class="n">ligand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-and-constitutional-characterization">
<h5>10.3 Spatial and constitutional characterization<a class="headerlink" href="#spatial-and-constitutional-characterization" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_results</span> <span class="o">=</span> <span class="s1">&#39;results.toml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">write_results</span><span class="p">(</span><span class="n">output_results</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="n">pdb</span><span class="p">,</span> <span class="n">ligand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">residues</span><span class="o">=</span><span class="n">residues</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-constitutional-and-depth-characterization">
<h5>10.4 Spatial, constitutional and depth characterization<a class="headerlink" href="#spatial-constitutional-and-depth-characterization" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_results</span> <span class="o">=</span> <span class="s1">&#39;results.toml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">write_results</span><span class="p">(</span><span class="n">output_results</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="n">pdb</span><span class="p">,</span> <span class="n">ligand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">avg_depth</span><span class="o">=</span><span class="n">avg_depth</span><span class="p">,</span> <span class="n">residues</span><span class="o">=</span><span class="n">residues</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spatial-constitutional-depth-and-hydropathy-characterization">
<h5>10.5 Spatial, constitutional, depth and hydropathy characterization<a class="headerlink" href="#spatial-constitutional-depth-and-hydropathy-characterization" title="Link to this heading"></a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output_results</span> <span class="o">=</span> <span class="s1">&#39;results.toml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyKVFinder</span><span class="o">.</span><span class="n">write_results</span><span class="p">(</span><span class="n">output_results</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="n">pdb</span><span class="p">,</span> <span class="n">ligand</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_cavity</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">,</span> <span class="n">avg_depth</span><span class="o">=</span><span class="n">avg_depth</span><span class="p">,</span> <span class="n">avg_hydropathy</span><span class="o">=</span><span class="n">avg_hydropathy</span><span class="p">,</span> <span class="n">residues</span><span class="o">=</span><span class="n">residues</span><span class="p">,</span> <span class="n">frequencies</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cavity nomenclature is based on the integer label. The cavity marked with 2, the first integer corresponding to a cavity, is KAA, the cavity marked with 3 is KAB, the cavity marked with 4 is KAC and so on.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/write_results.html">pyKVFinder.write_results</a></p></li>
</ul>
</div>
</section>
</section>
</section>
<section id="steered-detection">
<h3>Steered detection<a class="headerlink" href="#steered-detection" title="Link to this heading"></a></h3>
<p>All these steps showed so far were performed the detection on the whole target biomolecule; however, we can perform them on a custom 3D grid, where we can explore closed regions with a custom box, which can be defined by a <em>.toml</em> file.</p>
<p>There are three methods to define a custom 3D grid as shown in <a class="reference external" href="../_cfg_files/box_file_template.html">Box configuration file template</a>.</p>
<p>First, we will create a box <em>.toml</em> file with:</p>
<ul class="simple">
<li><p>Four vertices of the box (origin, X-axis, Y-axis and Z-axis):</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">toml</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;custom-box.toml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">box</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">box</span>
<span class="go">{&#39;box&#39;: {&#39;p1&#39;: [3.11, 7.34, 1.59], &#39;p2&#39;: [11.51, 7.34, 1.59], &#39;p3&#39;: [3.11, 10.74, 1.59], &#39;p4&#39;: [3.11, 7.34, 6.19]}}</span>
</pre></div>
</div>
<p>or</p>
<ul class="simple">
<li><p>A list of residues and a padding:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;residues-box.toml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">box</span> <span class="o">=</span> <span class="n">toml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">box</span>
<span class="go">{&#39;box&#39;: {&#39;residues&#39;: [[&#39;49&#39;, &#39;E&#39;, &#39;LEU&#39;], [&#39;50&#39;, &#39;E&#39;, &#39;GLY&#39;], [&#39;51&#39;, &#39;E&#39;, &#39;THR&#39;]], &#39;padding&#39;: 3.5}}</span>
</pre></div>
</div>
<p>A third way is to define a custom 3D grid with <a class="reference external" href="https://github.com/LBC-LNBio/parKVFinder">parKVFinder</a>’s TOML-formatted parameters file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="s1">&#39;box.toml&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">box</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="go">      [SETTINGS.visiblebox.p1]</span>
<span class="go">      x = 3.11</span>
<span class="go">      y = 7.34</span>
<span class="go">      z = 1.59</span>

<span class="go">      [SETTINGS.visiblebox.p2]</span>
<span class="go">      x = 11.51</span>
<span class="go">      y = 7.34</span>
<span class="go">      z = 1.59</span>

<span class="go">      [SETTINGS.visiblebox.p3]</span>
<span class="go">      x = 3.11</span>
<span class="go">      y = 10.74</span>
<span class="go">      z = 1.59</span>

<span class="go">      [SETTINGS.visiblebox.p4]</span>
<span class="go">      x = 3.11</span>
<span class="go">      y = 7.34</span>
<span class="go">      z = 6.19</span>
<span class="go">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">with open(fn, &#39;w&#39;) as f:</span>
<span class="gp">... </span><span class="s2">    toml.dump(toml.loads(box), f)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users can create this box with parKVFinder PyMOL plugin (PyMOL2 parKVFinder Tools) and save the parameters file from it.</p>
</div>
<section id="workflows">
<h4>Workflows<a class="headerlink" href="#workflows" title="Link to this heading"></a></h4>
<p>Then, you can explore the box adjustment mode with the standard and full workflows, defining the <code class="docutils literal notranslate"><span class="pre">box</span></code> parameter as the filepath of one box configuration file from above (<em>custom-box.toml</em>, <em>residues-box.toml</em> or <em>box.toml</em>).</p>
<p>For instance, with <em>custom-box.toml</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;1FMO.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Box configuration filepath</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;custom-box.toml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Standard workflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">run_workflow</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Full workflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">run_workflow</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">fn</span><span class="p">,</span> <span class="n">include_depth</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_hydropathy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hydrophobicity_scale</span><span class="o">=</span><span class="s1">&#39;EisenbergWeiss&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/run_workflow">pyKVFinder.run_workflow</a></p></li>
</ul>
</div>
</section>
<section id="id9">
<h4>Separated steps<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<p>If you are running pyKVFinder package in a step-by-step fashion (<a class="reference external" href="index.hmtl#separated-steps">Separated steps</a>), the steps <a class="reference external" href="index.hmtl#dimensioning-the-3d-grid">3</a> and <a class="reference external" href="index.hmtl#detecting-biomolecular-cavities">4</a> are different than before.</p>
<ul class="simple">
<li><p>Dimensioning the 3D grid: Instead of calling <code class="docutils literal notranslate"><span class="pre">pyKVFinder.get_vertices</span></code>, you call <code class="docutils literal notranslate"><span class="pre">pyKVFinder.get_vertices_from_file</span></code>.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">pyKVFinder.get_vertices_from_file</span></code> takes <em>.toml</em> file with box configuration or parKVFinder parameters file, the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom, and a collection of detection parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code> and <code class="docutils literal notranslate"><span class="pre">probe_out</span></code>), and returns a tuple with a NumPy array with vertice coordinates (origin, X-axis, Y-axis, Z-axis) of the 3D grid and the NumPy array with residue number, chain identifier, residue name, atom name, xyz coordinates and radius for each atom inside the custom box.</p>
<p>Users can define the <code class="docutils literal notranslate"><span class="pre">box</span></code> parameter as the filepath of one box configuration file from above (<em>custom-box.toml</em>, <em>residues-box.toml</em> or <em>box.toml</em>). For instance, with <em>custom-box.toml</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vertices</span><span class="p">,</span> <span class="n">atomic</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">get_vertices_from_file</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">atomic</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe_in</span><span class="o">=</span><span class="n">probe_in</span><span class="p">,</span> <span class="n">probe_out</span><span class="o">=</span><span class="n">probe_out</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code> and <code class="docutils literal notranslate"><span class="pre">probe_out</span></code> are not defined, the function automatically sets them to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.get_vertices_from_file('box.toml',</span> <span class="pre">atomic)</span></code>.</p>
</div>
<ul class="simple">
<li><p>Detecting biomolecular cavities: Now, you can explore this box adjustment mode, defining the <code class="docutils literal notranslate"><span class="pre">box_adjustment</span></code> parameter as <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ncav</span><span class="p">,</span> <span class="n">cavities</span> <span class="o">=</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">atomic</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe_in</span><span class="o">=</span><span class="n">probe_in</span><span class="p">,</span> <span class="n">probe_out</span><span class="o">=</span><span class="n">probe_out</span><span class="p">,</span> <span class="n">removal_distance</span><span class="o">=</span><span class="n">removal_distance</span><span class="p">,</span> <span class="n">volume_cutoff</span><span class="o">=</span><span class="n">volume_cutoff</span><span class="p">,</span> <span class="n">box_adjustment</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ncav</span>
<span class="go">1</span>
<span class="go">&gt;&gt; cavities</span>
<span class="go">array([[[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    ...,</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1]],</span>

<span class="go">    ...,</span>

<span class="go">    [[-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    ...,</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1],</span>
<span class="go">    [-1, -1, -1, ..., -1, -1, -1]]], dtype=int32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of the detection parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_in</span></code>, <code class="docutils literal notranslate"><span class="pre">probe_out</span></code>, <code class="docutils literal notranslate"><span class="pre">removal_distance</span></code>, <code class="docutils literal notranslate"><span class="pre">volume_cutoff</span></code>, <code class="docutils literal notranslate"><span class="pre">surface</span></code>) are not defined, the function automatically sets them to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">pyKVFinder.detect(atomic,</span> <span class="pre">vertices,</span> <span class="pre">box_adjustment=True)</span></code>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you are using box adjusment mode, do not forget to set <code class="docutils literal notranslate"><span class="pre">box_adjustment</span></code> flag to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference external" href="../api_reference/get_vertices_from_file.html">pyKVFinder.get_vertices_from_file</a></p></li>
<li><p><a class="reference external" href="../api_reference/detect.html">pyKVFinder.detect</a></p></li>
</ul>
</div>
</section>
</section>
</section>
<section id="molecular-volume">
<h2>Molecular volume<a class="headerlink" href="#molecular-volume" title="Link to this heading"></a></h2>
<p>All files used on this tutorial can be found in our package and in our <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder">GitHub repository</a>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/tests/ClO4.pdb">ClO4.pdb</a></p></li>
</ul>
<p>In this tutorial, we will use pyKVFinder on perchlorate (ClO<sub>4</sub> ) to estimate the molecular volume, using van der Waals (vdW) surface, solvent excluded surface (SES) and solvent accessible surface (SAS) to represent the molecular surface (see Figure below).</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><img alt="../../_images/vdw.png" src="../../_images/vdw.png" />
<p class="centered">
<strong>(a) vdW</strong></p></td>
<td><img alt="../../_images/ses.png" src="../../_images/ses.png" />
<p class="centered">
<strong>(b) SES</strong></p></td>
<td><img alt="../../_images/sas.png" src="../../_images/sas.png" />
<p class="centered">
<strong>(c) SAS</strong></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p class="centered">
<strong><strong>Molecular surface represenation</strong></strong></p></td>
</tr>
</tbody>
</table>
<p>First, we must load the target molecular structure (ClO<sub>4</sub> )  into <code class="docutils literal notranslate"><span class="pre">pyKVFinder.Molecule</span></code> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">pyKVFinder</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;tests&#39;</span><span class="p">,</span> <span class="s1">&#39;ClO4.pdb&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span> <span class="n">pyKVFinder</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span>
<span class="go">&lt;pyKVFinder.main.Molecule object at 0x7f5ddacf2230&gt;</span>
</pre></div>
</div>
<p>With the atomic information and vdW radii dictionary loaded, the molecule is inserted into a regular 3D grid, considering the vdW radii of any of the atoms. Natively, the vdW radii are taken from the <a class="reference external" href="https://github.com/LBC-LNBio/pyKVFinder/blob/master/pyKVFinder/data/vdw.dat">built-in dictionary</a>. In the 3D grid, each voxel corresponds to a molecule (0) or solvent (1) points. Here, we can model our molecule using the vdW surface, SES or SAS.</p>
<section id="vdw-volume">
<h3>1. vdW volume<a class="headerlink" href="#vdw-volume" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Molecule.vdw()</span></code> takes a grid spacing and returns a NumPy array with the molecule points representing the vdW surface in the 3D grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Grid Spacing (step): 0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">vdw</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">grid</span>
<span class="go">array([[[1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        ...,</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1]],</span>

<span class="go">        ...,</span>

<span class="go">      [[1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        ...,</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1]]], dtype=int32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">step</span></code> is not defined, the function automatically sets it to the default value. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">molecule.vdw()</span></code>.</p>
</div>
<p>We can preview our modelled molecule in the 3D grid by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;vdw-model.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/vdw-grid.png"><img alt="../../_images/vdw-grid.png" class="align-center" src="../../_images/vdw-grid.png" style="width: 500px;" /></a>
<p>We can also export our modelled molecule int the 3D grid by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">preview</span><span class="p">()</span>
</pre></div>
</div>
<p>Now, we can estimate the vdW volume by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">volume</span><span class="p">()</span>
<span class="go">83.64</span>
</pre></div>
</div>
</section>
<section id="ses-volume">
<h3>2. SES volume<a class="headerlink" href="#ses-volume" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Molecule.surface()</span></code> takes the grid spacing, the spherical probe size to model the surface, the SES representation and returns a NumPy array with the molecule points representing the SES in the 3D grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Grid Spacing (step): 0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spherical Probe (probe): 1.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Surface Representation: SES</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span> <span class="o">=</span> <span class="s1">&#39;SES&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe</span><span class="o">=</span><span class="n">probe</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">grid</span>
<span class="go">array([[[1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        ...,</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1]],</span>

<span class="go">        ...,</span>

<span class="go">      [[1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        ...,</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1]]], dtype=int32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of the parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code>, <code class="docutils literal notranslate"><span class="pre">probe</span></code> or <code class="docutils literal notranslate"><span class="pre">surface</span></code>) are not defined, the function automatically sets them to the default values. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">molecule.surface()</span></code>.</p>
</div>
<p>We can preview our modelled molecule in the 3D grid by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">preview</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/ses-grid.png"><img alt="../../_images/ses-grid.png" class="align-center" src="../../_images/ses-grid.png" style="width: 500px;" /></a>
<p>Now, we can estimate the vdW volume by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">volume</span><span class="p">()</span>
<span class="go">90.8</span>
</pre></div>
</div>
</section>
<section id="sas-volume">
<h3>3. SAS volume<a class="headerlink" href="#sas-volume" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Molecule.surface()</span></code> takes a grid spacing, a spherical probe to model the surface, a SAS representation and returns a NumPy array with the molecule points representing the SES in the 3D grid.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Grid Spacing (step): 0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Spherical Probe (probe): 1.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probe</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Surface Representation: SAS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span> <span class="o">=</span> <span class="s1">&#39;SAS&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">surface</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">probe</span><span class="o">=</span><span class="n">probe</span><span class="p">,</span> <span class="n">surface</span><span class="o">=</span><span class="n">surface</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">grid</span>
<span class="go">array([[[1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        ...,</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1]],</span>

<span class="go">        ...,</span>

<span class="go">      [[1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        ...,</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1],</span>
<span class="go">        [1, 1, 1, ..., 1, 1, 1]]], dtype=int32)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of the parameters (<code class="docutils literal notranslate"><span class="pre">step</span></code> or <code class="docutils literal notranslate"><span class="pre">probe</span></code>) are not defined, the function automatically sets them to the default values. So, you can call the function by <code class="docutils literal notranslate"><span class="pre">molecule.surface(surface='SAS')</span></code>.</p>
</div>
<p>We can preview our modelled molecule in the 3D grid by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">preview</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/sas-grid.png"><img alt="../../_images/sas-grid.png" class="align-center" src="../../_images/sas-grid.png" style="width: 500px;" /></a>
<p>Now, we can estimate the vdW volume by running:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">molecule</span><span class="o">.</span><span class="n">volume</span><span class="p">()</span>
<span class="go">340.28</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation/index.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api_reference/index.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, LBC-LNBio.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>